/*
 * Copyright 2019-2022 NXP
 *
 * SPDX-License-Identifier: BSD-3-Clause
 */
#include <lib/mmio.h>
#include <assert.h>
#include "s32g_pinctrl.h"

/* GPIOs for External Wakeup Sources */
#define SIUL2_PC_11_MSCR_S32_G1_WKUP0	43
#define SIUL2_PJ_02_MSCR_S32_G1_WKUP1	146
#define SIUL2_PJ_04_MSCR_S32_G1_WKUP2	148
#define SIUL2_PJ_06_MSCR_S32_G1_WKUP3	150
#define SIUL2_PJ_08_MSCR_S32_G1_WKUP4	152
#define SIUL2_PJ_10_MSCR_S32_G1_WKUP5	154
#define SIUL2_PJ_12_MSCR_S32_G1_WKUP6	156
#define SIUL2_PJ_14_MSCR_S32_G1_WKUP7	158
#define SIUL2_PK_00_MSCR_S32_G1_WKUP8	160
#define SIUL2_PK_02_MSCR_S32_G1_WKUP9	162
#define SIUL2_PK_04_MSCR_S32_G1_WKUP10	164
#define SIUL2_PK_06_MSCR_S32_G1_WKUP11	166
#define SIUL2_PK_08_MSCR_S32_G1_WKUP12	168
#define SIUL2_PK_10_MSCR_S32_G1_WKUP13	170
#define SIUL2_PK_12_MSCR_S32_G1_WKUP14	172
#define SIUL2_PK_14_MSCR_S32_G1_WKUP15	174
#define SIUL2_PL_00_MSCR_S32_G1_WKUP16	176
#define SIUL2_PC_04_MSCR_S32_G1_WKUP17	36
#define SIUL2_PC_06_MSCR_S32_G1_WKUP18	38
#define SIUL2_PL_07_MSCR_S32_G1_WKUP19	183
#define SIUL2_PL_03_MSCR_S32_G1_WKUP20	179
#define SIUL2_PL_06_MSCR_S32_G1_WKUP21	182
#define SIUL2_PA_10_MSCR_S32_G1_WKUP22	10

static const uint32_t wkpu_gpio[] = {
	SIUL2_0_MSCRn(SIUL2_PC_11_MSCR_S32_G1_WKUP0),
	SIUL2_1_MSCRn(SIUL2_PJ_02_MSCR_S32_G1_WKUP1),
	SIUL2_1_MSCRn(SIUL2_PJ_04_MSCR_S32_G1_WKUP2),
	SIUL2_1_MSCRn(SIUL2_PJ_06_MSCR_S32_G1_WKUP3),
	SIUL2_1_MSCRn(SIUL2_PJ_08_MSCR_S32_G1_WKUP4),
	SIUL2_1_MSCRn(SIUL2_PJ_10_MSCR_S32_G1_WKUP5),
	SIUL2_1_MSCRn(SIUL2_PJ_12_MSCR_S32_G1_WKUP6),
	SIUL2_1_MSCRn(SIUL2_PJ_14_MSCR_S32_G1_WKUP7),
	SIUL2_1_MSCRn(SIUL2_PK_00_MSCR_S32_G1_WKUP8),
	SIUL2_1_MSCRn(SIUL2_PK_02_MSCR_S32_G1_WKUP9),
	SIUL2_1_MSCRn(SIUL2_PK_04_MSCR_S32_G1_WKUP10),
	SIUL2_1_MSCRn(SIUL2_PK_06_MSCR_S32_G1_WKUP11),
	SIUL2_1_MSCRn(SIUL2_PK_08_MSCR_S32_G1_WKUP12),
	SIUL2_1_MSCRn(SIUL2_PK_10_MSCR_S32_G1_WKUP13),
	SIUL2_1_MSCRn(SIUL2_PK_12_MSCR_S32_G1_WKUP14),
	SIUL2_1_MSCRn(SIUL2_PK_14_MSCR_S32_G1_WKUP15),
	SIUL2_1_MSCRn(SIUL2_PL_00_MSCR_S32_G1_WKUP16),
	SIUL2_0_MSCRn(SIUL2_PC_04_MSCR_S32_G1_WKUP17),
	SIUL2_0_MSCRn(SIUL2_PC_06_MSCR_S32_G1_WKUP18),
	SIUL2_1_MSCRn(SIUL2_PL_07_MSCR_S32_G1_WKUP19),
	SIUL2_1_MSCRn(SIUL2_PL_03_MSCR_S32_G1_WKUP20),
	SIUL2_1_MSCRn(SIUL2_PL_06_MSCR_S32_G1_WKUP21),
	SIUL2_0_MSCRn(SIUL2_PA_10_MSCR_S32_G1_WKUP22),
};

void wkpu_config_pinctrl(uint32_t wkup_irq)
{
	mmio_write_32(wkpu_gpio[wkup_irq],
		      SIUL2_MSCR_S32_G1_IBE_EN |
		      SIUL2_MSCR_MUX_MODE_ALT0);
}

void i2c_config_pinctrl(void)
{
	/* Plaftorm board - PCI X16 Express (J99) */
	/* I2C1 Serial Data Input */
	mmio_write_32(SIUL2_0_MSCRn(SIUL2_MSCR_S32G_PB_04),
			SIUL2_MSCR_S32G_PAD_CTRL_I2C1_SDA);
	mmio_write_32(SIUL2_1_IMCRn(SIUL2_PB_04_IMCR_S32G_I2C1_SDA),
			SIUL2_IMCR_S32G_PAD_CTRL_I2C1_SDA);

	/* I2C1 Serial Clock Input */
	mmio_write_32(SIUL2_0_MSCRn(SIUL2_MSCR_S32G_PB_03),
			SIUL2_MSCR_S32G_PAD_CTRL_I2C1_SCLK);
	mmio_write_32(SIUL2_1_IMCRn(SIUL2_PB_03_IMCR_S32G_I2C1_SCLK),
			SIUL2_IMCR_S32G_PAD_CTRL_I2C1_SCLK);

	/* EEPROM - AT24C01B */
	/* I2C0 Serial Data Input */
	mmio_write_32(SIUL2_0_MSCRn(SIUL2_MSCR_S32G_PB_00),
			SIUL2_MSCR_S32G_PAD_CTRL_I2C0_SDA);
	mmio_write_32(SIUL2_0_IMCRn(SIUL2_PB_00_IMCR_S32G_I2C0_SDA),
			SIUL2_IMCR_S32G_PAD_CTRL_I2C0_SDA);

	/* I2C0 Serial Clock Input */
	mmio_write_32(SIUL2_0_MSCRn(SIUL2_MSCR_S32G_PB_01),
			SIUL2_MSCR_S32G_PAD_CTRL_I2C0_SCLK);
	mmio_write_32(SIUL2_0_IMCRn(SIUL2_PB_01_IMCR_S32G_I2C0_SCLK),
			SIUL2_IMCR_S32G_PAD_CTRL_I2C0_SCLK);

	/* PMIC - I2C4 */
	/* I2C4 Serial Data Input */
	mmio_write_32(SIUL2_0_MSCRn(SIUL2_MSCR_S32G_PC_01),
			SIUL2_MSCR_S32G_PAD_CTRL_I2C4_SDA);
	mmio_write_32(SIUL2_1_IMCRn(SIUL2_PC_01_IMCR_S32G_I2C4_SDA),
			SIUL2_IMCR_S32G_PAD_CTRL_I2C4_SDA);

	/* I2C4 Serial Clock Input */
	mmio_write_32(SIUL2_0_MSCRn(SIUL2_MSCR_S32G_PC_02),
			SIUL2_MSCR_S32G_PAD_CTRL_I2C4_SCLK);
	mmio_write_32(SIUL2_1_IMCRn(SIUL2_PC_02_IMCR_S32G_I2C4_SCLK),
			SIUL2_IMCR_S32G_PAD_CTRL_I2C4_SCLK);
}
